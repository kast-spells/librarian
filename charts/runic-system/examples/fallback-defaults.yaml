# Fallback Defaults Example
# Tests runicIndexer default fallback behavior (book vs chapter defaults)

chapter:
  name: production

# Lexicon with default configurations (dictionary format)
lexicon:
  book-default-gateway:
    type: istio-gw
    labels:
      access: public
      default: book
    gateway: istio-system/book-gateway
    baseURL: book.example.com

  chapter-default-gateway:
    type: istio-gw
    labels:
      access: public
      default: chapter
    chapter: production
    gateway: istio-system/chapter-gateway
    baseURL: chapter.example.com

  specific-gateway:
    type: istio-gw
    labels:
      access: private
    gateway: istio-system/private-gateway
    baseURL: private.example.com

# Expected result: chapter-default-gateway
# Selector access=unknown doesn't match any gateway
# Falls back to chapter default first (chapter=production), then book default
# chapter-default-gateway: EXPECTED - default=chapter AND chapter=production
# book-default-gateway: FALLBACK - default=book (but chapter default takes precedence)

glyphs:
  istio:
    test-fallback:
      type: virtualService
      enabled: true
      selector:
        access: unknown
      subdomain: fallback-test
      httpRules:
        - prefix: /
          port: 8080